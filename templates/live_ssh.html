<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Sentinel Hive - Live SSH</title>
	<style>
		:root {
			--bg: #0b1220; --panel: #0f172a; --card: #111827; --accent: #22d3ee; --accent-2: #f97316;
			--text: #e8ecf3; --muted: #a5b4c6; --font: 'JetBrains Mono', 'IBM Plex Mono', 'SFMono-Regular', Menlo, Consolas, monospace;
		}
		* { box-sizing: border-box; }
		body { margin: 0; background: radial-gradient(circle at 20% 20%, #132644, var(--bg)); color: var(--text); font-family: var(--font); font-size: 14px; line-height: 1.55; min-height: 100vh; }
		header { padding: 20px 24px; display: flex; align-items: center; justify-content: space-between; border-bottom: 1px solid #1f2937; background: linear-gradient(90deg, #0f172a, #0b1220); position: sticky; top: 0; z-index: 10; }
		.brand { letter-spacing: 3px; text-transform: uppercase; color: var(--accent); font-weight: 800; font-size: 18px; }
		.sub { color: var(--muted); font-size: 13px; margin-top: 6px; }
		main { padding: 22px 24px 54px 24px; max-width: 1280px; margin: auto; }
		.actions { display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }
		.nav { display: flex; gap: 10px; align-items: center; }
		.nav-link { text-decoration: none; color: var(--muted); padding: 8px 12px; border-radius: 8px; border: 1px solid #1f2937; font-weight: 700; font-size: 13px; }
		.nav-link:hover { border-color: var(--accent); color: var(--accent); }
		.nav-active { border-color: var(--accent); color: var(--accent); }
		.frame-wrap { background: var(--panel); border: 1px solid #1f2937; border-radius: 12px; overflow: hidden; }
		.info { color: var(--muted); margin: 10px 0; }
		.pill { background: #1b2435; border-radius: 22px; padding: 6px 12px; font-size: 12px; color: var(--muted); border: 1px solid #1f2937; }
		button { background: var(--accent); color: #0b1220; border: none; padding: 8px 12px; border-radius: 8px; cursor: pointer; font-weight: 800; letter-spacing: 0.5px; font-size: 13px; box-shadow: 0 4px 12px #22d3ee44; }
	</style>
</head>
<body>
	<header>
		<div>
			<div class="brand">Sentinel Hive / Live SSH</div>
			<div class="sub">Live Cowrie telemetry - watching SSH sessions in real time</div>
		</div>
		<div class="actions">
			<nav class="nav">
				<a class="nav-link" href="/">Dashboard</a>
				<a class="nav-link" href="/live-http">Live HTTP</a>
				<a class="nav-link nav-active" href="/live-ssh">Live SSH</a>
				<a class="nav-link" href="/replay-ssh">Replay</a>
				<a class="nav-link" href="/ssh-session-replay">Sessions</a>
			</nav>
		</div>
	</header>

	<main>
		<div class="info" style="display:flex; align-items:center; gap:10px; flex-wrap:wrap;">
			<span class="pill" id="conn-status">Connected</span>
			<span class="pill">Feed: Cowrie SSH (10.0.96.70)</span>
			<details style="color: var(--muted);">
				<summary style="cursor:pointer;">Details</summary>
				<div style="padding-top:6px; font-size:12px;">Path: {{ ssh_log }}</div>
			</details>
		</div>
		<div style="display:flex; align-items:center; gap:10px; margin:8px 0 10px 0; flex-wrap:wrap;">
			<button id="follow-toggle" class="pill" style="cursor:pointer;">Auto-follow: ON</button>
			<span class="muted" style="font-size:12px;">Pins to latest activity</span>
		</div>
		<div class="frame-wrap" style="padding:0;">
			<pre id="log-view" style="margin:0; padding:12px; background:#0b1220; color:#e8ecf3; font-size:12.5px; line-height:1.45; white-space:pre-wrap; word-break:break-word; font-family: 'JetBrains Mono', 'IBM Plex Mono', monospace; overflow-y:auto; max-height:80vh;"></pre>
		</div>
	</main>

	<script>
		const logView = document.getElementById('log-view');
		const followBtn = document.getElementById('follow-toggle');
		const connStatus = document.getElementById('conn-status');
		let followOn = true;

		function isAtBottom(el) {
			return el.scrollTop + el.clientHeight >= el.scrollHeight - 10;
		}

		function maintainScroll() {
			if (followOn && isAtBottom(logView)) {
				logView.scrollTop = logView.scrollHeight;
			}
		}

		followBtn.addEventListener('click', () => {
			followOn = !followOn;
			followBtn.textContent = followOn ? 'Auto-follow: ON' : 'Auto-follow: OFF';
		});

		const src = new EventSource('/ssh-stream-proxy');
		src.onmessage = (event) => {
			connStatus.textContent = 'Connected';
			connStatus.classList.remove('warn');
			logView.textContent += (event.data || '') + "\n";
			maintainScroll();
		};
		src.onerror = () => {
			connStatus.textContent = 'Reconnectingâ€¦';
			connStatus.classList.add('warn');
		};
	</script>
</body>
</html>

